// https://github.com/johnwalley/d3-simple-slider v1.10.0 Copyright 2020 John Walley
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-transition"),require("d3-axis"),require("d3-array"),require("d3-scale"),require("d3-selection"),require("d3-dispatch"),require("d3-drag"),require("d3-ease")):"function"==typeof define&&define.amd?define(["exports","d3-transition","d3-axis","d3-array","d3-scale","d3-selection","d3-dispatch","d3-drag","d3-ease"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).d3=t.d3||{},t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3)}(this,(function(t,e,a,n,r,l,i,u,s){"use strict";function c(t){return function(e,a){e&&e.target?t.call(this,e,a):t.call(this,l.event,e)}}function o(t){return"translate("+t+",0)"}function d(t){return"translate(0,"+t+")"}function f(t,e){e=void 0!==e?e.copy():null;var f=[0],g=[0],h=[0,10],m=100,p=100,v=!0,x="M-5.5,-5.5v10l6,5.5l6,-5.5v-10z",k=null,y=null,b=3,A=null,w=null,D=null,M=null,q=null,z=i.dispatch("onchange","start","end","drag"),F=null,L=null,P=null,T=1===t||4===t?-1:1,V=4===t||2===t?-1:1,O=4===t||2===t?"y":"x",R=4===t||2===t?"x":"y",B=1===t||3===t?o:d,E=1===t||3===t?d:o,j=null;switch(t){case 1:j=a.axisTop;break;case 2:j=a.axisRight;break;case 3:j=a.axisBottom;break;case 4:j=a.axisLeft}var H=null,Q=null;function U(a){F=a.selection?a.selection():a,e||(e=(e=h[0]instanceof Date?r.scaleTime():r.scaleLinear()).domain(h).range(1===t||3===t?[0,m]:[p,0]).clamp(!0)),L=r.scaleLinear().range(e.range()).domain(e.range()).clamp(!0),f=f.map((function(t){return r.scaleLinear().range(h).domain(h).clamp(!0)(t)})),w=w||e.tickFormat(),M=M||w||e.tickFormat(),F.selectAll(".axis").data([null]).enter().append("g").attr("transform",E(7*T)).attr("class","axis");var i=F.selectAll(".slider").data([null]),s=i.enter().append("g").attr("class","slider").attr("cursor",1===t||3===t?"ew-resize":"ns-resize").call(u.drag().on("start",c((function(a){l.select(this).classed("active",!0);var r=L(3===t||1===t?a.x:a.y);P=f[0]===h[0]&&f[1]===h[0]?1:f[0]===h[1]&&f[1]===h[1]?0:n.scan(f.map((function(t){return Math.abs(t-C(e.invert(r)))})));var u=f.map((function(t,a){return a===P?C(e.invert(r)):t}));I(u),z.call("start",i,1===u.length?u[0]:u),G(u,!0)}))).on("drag",c((function(e){var a=d(L(3===t||1===t?e.x:e.y));I(a),z.call("drag",i,1===a.length?a[0]:a),G(a,!0)}))).on("end",c((function(e){l.select(this).classed("active",!1);var a=d(L(3===t||1===t?e.x:e.y));I(a),z.call("end",i,1===a.length?a[0]:a),G(a,!0),P=null}))));s.append("line").attr("class","track").attr(O+"1",e.range()[0]-8*V).attr("stroke","#bbb").attr("stroke-width",6).attr("stroke-linecap","round"),s.append("line").attr("class","track-inset").attr(O+"1",e.range()[0]-8*V).attr("stroke","#eee").attr("stroke-width",4).attr("stroke-linecap","round"),q&&s.append("line").attr("class","track-fill").attr(O+"1",1===f.length?e.range()[0]-8*V:e(f[0])).attr("stroke",q).attr("stroke-width",4).attr("stroke-linecap","round"),s.append("line").attr("class","track-overlay").attr(O+"1",e.range()[0]-8*V).attr("stroke","transparent").attr("stroke-width",40).attr("stroke-linecap","round").merge(i.select(".track-overlay"));var o=s.selectAll(".parameter-value").data(f.map((function(t,e){return{value:t,index:e}}))).enter().append("g").attr("class","parameter-value").attr("transform",(function(t){return B(e(t.value))})).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle");function d(t){var a=C(e.invert(t));return f.map((function(t,e){return 2===f.length?e===P?0===P?Math.min(a,C(f[1])):Math.max(a,C(f[0])):t:e===P?a:t}))}o.append("path").attr("transform","rotate("+90*(t+1)+")").attr("d",x).attr("class","handle").attr("aria-label","handle").attr("aria-valuemax",h[1]).attr("aria-valuemin",h[0]).attr("aria-valuenow",(function(t){return t.value})).attr("aria-orientation",4===t||2===t?"vertical":"horizontal").attr("focusable","true").attr("tabindex",0).attr("fill","white").attr("stroke","#777").on("keydown",c((function(t,e){var a=k||(h[1]-h[0])/100;function n(t){return f.map((function(a,n){return 2===f.length?n===e.index?0===e.index?Math.min(t,C(f[1])):Math.max(t,C(f[0])):a:n===e.index?t:a}))}switch(t.key){case"ArrowLeft":case"ArrowDown":U.value(n(+f[e.index]-a)),t.preventDefault();break;case"PageDown":U.value(n(+f[e.index]-2*a)),t.preventDefault();break;case"ArrowRight":case"ArrowUp":U.value(n(+f[e.index]+a)),t.preventDefault();break;case"PageUp":U.value(n(+f[e.index]+2*a)),t.preventDefault();break;case"Home":U.value(n(h[0])),t.preventDefault();break;case"End":U.value(n(h[1])),t.preventDefault()}}))),v&&o.append("text").attr("font-size",10).attr(R,T*(24+b)).attr("dy",1===t?"0em":3===t?".71em":".32em").attr("transform",f.length>1?"translate(0,0)":null).text((function(t,e){return w(f[e])})),a.select(".track").attr(O+"2",e.range()[1]+8*V),a.select(".track-inset").attr(O+"2",e.range()[1]+8*V),q&&a.select(".track-fill").attr(O+"2",1===f.length?e(f[0]):e(f[1])),a.select(".track-overlay").attr(O+"2",e.range()[1]+8*V),a.select(".axis").call(j(e).tickFormat(w).ticks(D).tickValues(y).tickPadding(b)),F.select(".axis").select(".domain").remove(),a.select(".axis").attr("transform",E(7*T)),a.selectAll(".axis text").attr("fill","#aaa").attr(R,T*(17+b)).attr("dy",1===t?"0em":3===t?".71em":".32em").attr("text-anchor",2===t?"start":4===t?"end":"middle"),a.selectAll(".axis line").attr("stroke","#aaa"),a.selectAll(".parameter-value").attr("transform",(function(t){return B(e(t.value))})),_(),Q=F.selectAll(".parameter-value text"),H=F.select(".track-fill")}function _(){if(F&&v){var t=[];if(f.forEach((function(e){var a=[];F.selectAll(".axis .tick").each((function(t){a.push(Math.abs(t-e))})),t.push(n.scan(a))})),F.selectAll(".axis .tick text").attr("opacity",(function(e,a){return~t.indexOf(a)?0:1})),Q&&f.length>1){var e,a,r=[],l=[];Q.nodes().forEach((function(t,n){e=t.getBoundingClientRect(),a=t.getAttribute("transform").split(/[()]/)[1].split(",")["x"===O?0:1],r[n]=e[O]-parseFloat(a),l[n]=e["x"===O?"width":"height"]})),"x"===O?(a=Math.max(0,(r[0]+l[0]-r[1])/2),Q.attr("transform",(function(t,e){return"translate("+(1===e?a:-a)+",0)"}))):(a=Math.max(0,(r[1]+l[1]-r[0])/2),Q.attr("transform",(function(t,e){return"translate(0,"+(1===e?-a:a)+")"})))}}}function C(t){if(k){var e=(t-h[0])%k,a=t-e;return 2*e>k&&(a+=k),t instanceof Date?new Date(a):a}if(A){var r=n.scan(A.map((function(e){return Math.abs(t-e)})));return A[r]}return t}function G(t,e){(f[0]!==t[0]||f.length>1&&f[1]!==t[1])&&(f=t,e&&z.call("onchange",U,1===t.length?t[0]:t),_())}function I(t,a){F&&((a=void 0!==a&&a)?(F.selectAll(".parameter-value").data(t.map((function(t,e){return{value:t,index:e}}))).transition().ease(s.easeQuadOut).duration(200).attr("transform",(function(t){return B(e(t.value))})).select(".handle").attr("aria-valuenow",(function(t){return t.value})),q&&H.transition().ease(s.easeQuadOut).duration(200).attr(O+"1",1===f.length?e.range()[0]-8*T:e(t[0])).attr(O+"2",1===f.length?e(t[0]):e(t[1]))):(F.selectAll(".parameter-value").data(t.map((function(t,e){return{value:t,index:e}}))).attr("transform",(function(t){return B(e(t.value))})).select(".handle").attr("aria-valuenow",(function(t){return t.value})),q&&H.attr(O+"1",1===f.length?e.range()[0]-8*T:e(t[0])).attr(O+"2",1===f.length?e(t[0]):e(t[1]))),v&&Q.text((function(e,a){return M(t[a])})))}return e&&(h=[n.min(e.domain()),n.max(e.domain())],1===t||3===t?m=n.max(e.range())-n.min(e.range()):p=n.max(e.range())-n.min(e.range()),e=e.clamp(!0)),U.min=function(t){return arguments.length?(h[0]=t,e&&e.domain(h),U):h[0]},U.max=function(t){return arguments.length?(h[1]=t,e&&e.domain(h),U):h[1]},U.domain=function(t){return arguments.length?(h=t,e&&e.domain(h),U):h},U.width=function(t){return arguments.length?(m=t,e&&e.range([e.range()[0],e.range()[0]+m]),U):m},U.height=function(t){return arguments.length?(p=t,e&&e.range([e.range()[0],e.range()[0]+p]),U):p},U.tickFormat=function(t){return arguments.length?(w=t,U):w},U.displayFormat=function(t){return arguments.length?(M=t,U):M},U.ticks=function(t){return arguments.length?(D=t,U):D},U.value=function(t){if(!arguments.length)return 1===f.length?f[0]:f;var a=Array.isArray(t)?t:[t];if(a.sort((function(t,e){return t-e})),e){var n=a.map(e).map(L),r=n.map(e.invert).map(C);I(r,!0),G(r,!0)}else f=a;return U},U.silentValue=function(t){if(!arguments.length)return 1===f.length?f[0]:f;var a=Array.isArray(t)?t:[t];if(a.sort((function(t,e){return t-e})),e){var n=a.map(e).map(L),r=n.map(e.invert).map(C);I(r,!1),G(r,!1)}else f=a;return U},U.default=function(t){if(!arguments.length)return 1===g.length?g[0]:g;var e=Array.isArray(t)?t:[t];return e.sort((function(t,e){return t-e})),g=e,f=e,U},U.step=function(t){return arguments.length?(k=t,U):k},U.tickValues=function(t){return arguments.length?(y=t,U):y},U.tickPadding=function(t){return arguments.length?(b=t,U):b},U.marks=function(t){return arguments.length?(A=t,U):A},U.handle=function(t){return arguments.length?(x=t,U):x},U.displayValue=function(t){return arguments.length?(v=t,U):v},U.fill=function(t){return arguments.length?(q=t,U):q},U.on=function(){var t=z.on.apply(z,arguments);return t===z?U:t},U}t.sliderBottom=function(t){return f(3,t)},t.sliderHorizontal=function(t){return f(3,t)},t.sliderLeft=function(t){return f(4,t)},t.sliderRight=function(t){return f(2,t)},t.sliderTop=function(t){return f(1,t)},t.sliderVertical=function(t){return f(4,t)},Object.defineProperty(t,"__esModule",{value:!0})}));